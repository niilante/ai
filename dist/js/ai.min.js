!function(e,t,r){"use strict";angular.module("ai",["ai.storage","ai.passport","ai.click2call","ai.viewer","ai.autoform","ai.nicescroll"]),angular.module("ai.autoform",[]).provider("$autoform",function(){var e,t,r={prefix:"",labels:!1};return t=function(e){r=angular.extend(r,e)},e=["$rootScope","$compile",function(e,t){function o(e){var t="";return angular.forEach(e,function(e,r){t+=r+'="'+e+'"'}),t}function n(n,a){var i,l={},c="";return i=a.scope||e.$new(),a=i.options=angular.extend(r,a),angular.forEach(a.model,function(e,t){var r,n,l,u,s=a.config[t]||{},p=t.charAt(0).toUpperCase()+t.slice(1);if(s){if(u=s.type||"text",r=o(s.attributes),l=a.prefix?' ng-model="'+a.prefix+"."+t+'" ':' ng-model="'+t+'" ',l=s.model===!1?"":l,n=s.attributes&&s.attributes.name?"":' name="'+t+'" ',c+="radio"!==u&&"checkbox"!==u?'<div class="form-group">':'<div class="'+u+'">',s.label&&(c+="radio"!==u&&"checkbox"!==u?"<label>"+p+"</label>":"<label>"),"select"===u||"textarea"===u)if("textarea"===u)c+="<textarea"+n+l+'class="form-control"></textarea>';else{i.items=s.items;var m=angular.isObject(s.data)?"key as value for (key, value) in list":"item."+s.value+" as item."+s.text+" for item in items",d="<select"+n+l+'class="form-control"'+r+'><option ng-options="'+m+'"></option></select>';c+=d}else c+="checkbox"===u||"radio"===u?"<input"+n+l+'type="'+u+'"'+r+"/> "+p+"</label>":"<input"+n+l+'type="'+u+'" class="form-control"'+r+"/>";s.help&&(c+='<p class="help-block">'+s.help+"</p>"),c+="</div>"}}),c+='<div class="form-buttons"><button type="submit" class="btn btn-primary">Submit</button></div>',c=t(c)(i),n.empty().html(c),l}return n}],{$get:e,$set:t}}).directive("aiAutoform",["$rootScope","$autoform",function(e,t){return console.log("auto form"),{scope:{options:"&aiAutoform",model:"=ngModel"},link:function(e,r){function o(){a.model=a.model||e.model,i=t(r,a)}var n,a,i;n={scope:e},a=angular.extend(n,e.$eval(e.options)),o()}}}]),angular.module("ai.click2call",[]).provider("$click2call",function(){var e,o,n,a;return e={gvid:r,template:"ai-click2call",message:"O.K we're calling to connect you! Be just a sec..."},a='<form name="c2cForm" class="ai-click2call" novalidate ng-submit="call(c2cForm, model)"><div class="form-group"><input class="form-control" name="name" type="text" ng-model="model.name" placeholder="Name (optional)" /></div><div class="form-group"><input class="form-control" name="number" type="text" ng-model="model.number" placeholder="Number (7605551212)" required/><span class="ai-click2call-error" ng-show="c2cForm.name.$error.required || (c2cForm.$dirty && c2cForm.$invalid)">Your number is required.</span></div><p><button class="btn btn-primary btn-block" type="submit">Call Now</button></p><p class="ai-click2call-message" ng-show="model.calling" ng-bind="model.message"></p></form>',n=function(t){e=angular.extend(e,t)},o=["$rootScope","$templateCache","$http","$q","$compile",function(r,o,n,i,l){function c(o,n){function a(e,r,o){var n,a,i,l=t.createElement("iframe");if(l.style.width=0,l.style.height=0,l.style.border=0,t.body.appendChild(l),l.contentDocument?n=l.contentDocument:l.contentWindow?n=l.contentWindow.document:l.document&&(n=l.document),null===n)throw new Error("Document not initialized");n.open(),n.write(""),n.close(),a=n.createElement("form"),a.method="post",a.action="https://clients4.google.com/voice/embed/webButtonConnect",i=n.createElement("input"),i.type="text",i.name="buttonId",i.value=""+e,a.appendChild(i),i=n.createElement("input"),i.type="text",i.name="callerNumber",i.value=""+r,a.appendChild(i),i=n.createElement("input"),i.type="text",i.name="name",i.value=""+o,a.appendChild(i),i=n.createElement("input"),i.type="text",i.name="showCallerNumber",i.value="1",a.appendChild(i),n.body.appendChild(a),a.submit()}var i,c={};return i=n.scope||r.$new(),n=i.options=angular.extend(e,n),i.model={message:n.message},i.call=c.call=function(e,t){if(!t||!t.number)return alert("Oops you forgot your number!");if(e.$valid){if(t.number=t.number.replace(/\D/g,""),t.calling=!0,t.number.length<10)return alert("Oops that doesn't look like enough numbers.");"1"!==t.number.charAt(0)&&(t.number="1"+t.number),a(n.gvid,t.number,t.name||"Unknown")}},u.fetch(n.template).then(function(e){e=l(e)(i),o.append(e)}),c}var u={find:function(e,r){return angular.element((r||t).querySelectorAll(e))},fetch:function(e){return i.when(o.get(e)||n.get(e)).then(function(t){return angular.isObject(t)?(o.put(e,t.data),t.data):t})},isHtml:function(e){var t="<(br|basefont|hr|input|source|frame|param|area|meta|!--|col|link|option|base|img|wbr|!DOCTYPE).*?>|<(a|abbr|acronym|address|applet|article|aside|audio|b|bdi|bdo|big|blockquote|body|button|canvas|caption|center|cite|code|colgroup|command|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fieldset|figcaption|figure|font|footer|form|frameset|head|header|hgroup|h1|h2|h3|h4|h5|h6|html|i|iframe|ins|kbd|keygen|label|legend|li|map|mark|menu|meter|nav|noframes|noscript|object|ol|optgroup|output|p|pre|progress|q|rp|rt|ruby|s|samp|script|section|select|small|span|strike|strong|style|sub|summary|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video).*?</2>",r=new RegExp(t);return r.test(e)},isPath:function(e){var t=e.split(".").pop();return"html"===t||"tpl"===t}};return e.template&&(o.get(e.template)||o.put(e.template,a)),c}],{$set:n,$get:o}}).directive("aiClick2call",["$click2call",function(e){return{restrict:"EAC",scope:{options:"&aiClick2call"},link:function(t,r){var o,n,a,i;o={scope:t},a=function(){n=e(r,i)},i=angular.extend(o,t.$eval(t.options)),a()}}}]),angular.module("ai.nicescroll",[]).directive("aiNicescroll",[function(){return{restrict:"EAC",scope:{options:"&aiNicescroll"},link:function(t,r){var o,n,a;console.assert(e.NiceScroll,"ai-nicescroll requires the NiceScroll library see: http://areaaperta.com/nicescroll/"),o={horizrailenabled:!1},n=function(){a=r.niceScroll(t.options)},t.options=angular.extend(o,t.$eval(t.options)),n()}}}]),angular.module("ai.viewer",[]).provider("$viewer",function(){var e,r,o={view:"<div ng-view />",animate:"slide"};return r=function(e){o=angular.extend(o,e)},e=["$rootScope","$compile","$location",function(e,r,n){function a(a,c){var u,s,p={};return s=c.scope||e.$new(),c=s.options=angular.extend(o,c),u=angular.element(s.options.view),u.addClass("ai-viewer-view"),s.options.animate&&u.attr("ng-class","state"),u=r(u)(s),a.addClass("ai-viewer"),a.append(u),p.getView=function(){return angular.element(t.querySelectorAll(".ai-viewer-view")[0])},p.getState=function(){return i},p.forward=function(e){n.path(e)},p.backward=function(e){l.push(e),n.path(e)},p}var i,l=[],c=!1;return e.$on("$routeChangeStart",function(e,t,r){var o=l.slice(0).pop(),n=t.$$route.originalPath;r=r||{$$route:"/"},c?n===o?(i="back",l.pop()):(i="forward",l.push(r.$$route.originalPath)):c=!0}),a}],{$get:e,$set:r}}).directive("aiViewer",["$rootScope","$viewer",function(e,t){return{restrict:"EA",scope:{options:"&aiViewer"},link:function(r,o){var n,a,i,l;n={scope:r},a=function(){l=t(o,i),e.$on("$routeChangeSuccess",function(){var e=l.getState(),t=l.getView();e&&r.options.animate&&t&&t.removeClass("forward"===e?"back":"forward").addClass(e),r.state=e})},i=angular.extend(n,r.$eval(r.options)),a()}}}]),angular.module("ai.passport",[]).provider("$passport",function(){var e,t,o;return e={map:{0:"*",1:"user",2:"manager",3:"admin",4:"superadmin"},defaultUrl:"/",loginUrl:"/api/passport/login",logoutUrl:"/api/passport/logout",resetUrl:"/api/passport/reset",recoverUrl:"/api/passport/recover",onSuccess:r,onFailed:r,onForbidden:r,onError:r},o=function(t){e=angular.extend(e,t)},t=["$rootScope","$location",function(){function t(t){return t=t||{},e.map=t.map||e.map,this.options=angular.extend(e,t),this}function r(){return o||(o=new t,t.constructor=null),o}var o;return t.prototype.login=function(){},t.prototype.logout=function(){},t.prototype.recover=function(){},t.prototype.reset=function(){},t.prototype.hasRole=function(){},t.prototype.hasAnyRole=function(){},r()}],{$get:t,$set:o}}).factory("passportInterceptor",["$q","$location","$passport",function(e){return{responseError:function(t){var r=t.status||500;switch(r){case 401:break;case 403:}return e.reject(t)}}}]).config(["$httpProvider",function(e){e.interceptors.push("passportInterceptor")}]),angular.module("ai.storage",[]).provider("$storage",function(){function o(r){return r?navigator.cookieEnabled||"cookie"in t&&(t.cookie.length>0||(t.cookie="test").indexOf.call(t.cookie,"test")>-1):"localStorage"in e&&null!==e.localStorage}function n(e,t,r,o){if(!t)return r;r=r||null,o=o||0;var a=t.length;for(var i in e)if(e.hasOwnProperty(i)&&i===t[o])return a-1>o&&angular.isObject(e[i])?(o+=1,n(e[i],t,r,o)||r):e[i]||r;return r}var a,i,l={ns:"app",cookiePath:"/",cookieExpiry:30};return i=function(e){l=angular.extend(l,e)},a=[function(){function e(e){function a(){if(!w)return new Error("Keys can only be obtained when localStorage is available.");var e=[];for(var t in localStorage)if(localStorage.hasOwnProperty(t)&&t.substr(0,v)===b)try{e.push(t.substr(v))}catch(r){return r}return e}function i(e,t){if(!w)return m(e,t);typeof t===r&&(t=null);try{(angular.isObject(t)||angular.isArray(t))&&(t=angular.toJson(t)),localStorage.setItem(b+e,t)}catch(o){return m(e,t)}}function c(e,t){var r;return t?u(e,t):w?(r=localStorage.getItem(b+e),r?"{"===r.charAt(0)||"["===r.charAt(0)?angular.fromJson(r):r:null):d(e)}function u(e,t){var r,o;return w?(r=c(e),o=angular.isObject(r)||!1,r?o?n(r,t):r:new Error("Invalid operation, storage item must be an object.")):new Error("Cannot get by property, localStorage must be enabled.")}function s(e){if(!w)return f(e);try{localStorage.removeItem(b+e)}catch(t){return f(e)}}function p(){if(!w)return g();for(var e in localStorage)if(localStorage.hasOwnProperty(e)&&e.substr(0,v)===b)try{s(e.substr(v))}catch(t){return g()}}function m(o,n){if(typeof n===r)return!1;if(!y)return new Error("Cookies are not supported by this browser.");try{var a="",i=new Date;null===n&&(h.expiry=-1,n=""),h.expiry&&(i.setTime(i.getTime()+24*e.cookieExpiry*60*60*1e3),a="; expires="+i.toGMTString()),o&&(t.cookie=b+o+"="+encodeURIComponent(n)+a+"; path="+e.cookiePath)}catch(l){throw l}}function d(e){if(!y)return new Error("Cookies are not supported by this browser.");for(var r=t.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(b+e+"="))return decodeURIComponent(n.substring(b.length+e.length+1,n.length))}return null}function f(e){m(e,null)}function g(){for(var e,r=null,o=t.cookie.split(";"),n=0;n<o.length;n++){for(r=o[n];" "===r.charAt(0);)r=r.substring(1,r.length);return e=r.substring(v,r.indexOf("=")),f(e)}}var b,h,v,y,w,$={};return e=angular.extend(l,e),b=e.ns+".",v=b.length,w=o(),y=o(!0),w||y?($.supports={localStorage:o(),cookies:o(!0)},$.get=c,$.set=i,$.delete=s,$.clear=p,$.storage={keys:a,supported:w},$.cookie={get:d,set:m,"delete":f,clear:g,supported:y},$):new Error("Storage Factory requires localStorage browser support or cookies must be enabled.")}return e}],{$set:i,$get:a}})}(window,document);