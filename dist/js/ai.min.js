!function(t,e,o){"use strict";angular.module("ai.autoform",[]).provider("$autoform",function(){var t,e,o={prefix:"",labels:!1};return e=function(t){o=angular.extend(o,t)},t=["$rootScope","$compile",function(t,e){function n(t){var e="";return angular.forEach(t,function(t,o){e+=o+'="'+t+'"'}),e}function r(r,a){var i,l={},s="";return i=a.scope||t.$new(),a=i.options=angular.extend(o,a),angular.forEach(a.model,function(t,e){var o,r,l,c,u=a.config[e]||{},p=e.charAt(0).toUpperCase()+e.slice(1);if(u){if(c=u.type||"text",o=n(u.attributes),l=a.prefix?' ng-model="'+a.prefix+"."+e+'" ':' ng-model="'+e+'" ',l=u.model===!1?"":l,r=u.attributes&&u.attributes.name?"":' name="'+e+'" ',s+="radio"!==c&&"checkbox"!==c?'<div class="form-group">':'<div class="'+c+'">',u.label&&(s+="radio"!==c&&"checkbox"!==c?"<label>"+p+"</label>":"<label>"),"select"===c||"textarea"===c)if("textarea"===c)s+="<textarea"+r+l+'class="form-control"></textarea>';else{i.items=u.items;var d=angular.isObject(u.data)?"key as value for (key, value) in list":"item."+u.value+" as item."+u.text+" for item in items",g="<select"+r+l+'class="form-control"'+o+'><option ng-options="'+d+'"></option></select>';s+=g}else s+="checkbox"===c||"radio"===c?"<input"+r+l+'type="'+c+'"'+o+"/> "+p+"</label>":"<input"+r+l+'type="'+c+'" class="form-control"'+o+"/>";u.help&&(s+='<p class="help-block">'+u.help+"</p>"),s+="</div>"}}),s+='<div class="form-buttons"><button type="submit" class="btn btn-primary">Submit</button></div>',s=e(s)(i),r.empty().html(s),l}return r}],{$get:t,$set:e}}).directive("aiAutoform",["$rootScope","$autoform",function(t,e){return console.log("auto form"),{scope:{options:"&aiAutoform",model:"=ngModel"},link:function(t,o){function n(){a.model=a.model||t.model,i=e(o,a)}var r,a,i;r={scope:t},a=angular.extend(r,t.$eval(t.options)),n()}}}]),angular.module("ai.click2call",[]).provider("$click2call",function(){var t,n,r,a;return t={gvid:o,template:"ai-click2call",message:"O.K we're calling to connect you! Be just a sec..."},a='<form name="c2cForm" class="ai-click2call" novalidate ng-submit="call(c2cForm, model)"><div class="form-group"><input class="form-control" name="name" type="text" ng-model="model.name" placeholder="Name (optional)" /></div><div class="form-group"><input class="form-control" name="number" type="text" ng-model="model.number" placeholder="Number (7605551212)" required/><span class="ai-click2call-error" ng-show="c2cForm.name.$error.required || (c2cForm.$dirty && c2cForm.$invalid)">Your number is required.</span></div><p><button class="btn btn-primary btn-block" type="submit">Call Now</button></p><p class="ai-click2call-message" ng-show="model.calling" ng-bind="model.message"></p></form>',r=function(e){t=angular.extend(t,e)},n=["$rootScope","$templateCache","$http","$q","$compile",function(o,n,r,i,l){function s(n,r){function a(t,o,n){var r,a,i,l=e.createElement("iframe");if(l.style.width=0,l.style.height=0,l.style.border=0,e.body.appendChild(l),l.contentDocument?r=l.contentDocument:l.contentWindow?r=l.contentWindow.document:l.document&&(r=l.document),null===r)throw new Error("Document not initialized");r.open(),r.write(""),r.close(),a=r.createElement("form"),a.method="post",a.action="https://clients4.google.com/voice/embed/webButtonConnect",i=r.createElement("input"),i.type="text",i.name="buttonId",i.value=""+t,a.appendChild(i),i=r.createElement("input"),i.type="text",i.name="callerNumber",i.value=""+o,a.appendChild(i),i=r.createElement("input"),i.type="text",i.name="name",i.value=""+n,a.appendChild(i),i=r.createElement("input"),i.type="text",i.name="showCallerNumber",i.value="1",a.appendChild(i),r.body.appendChild(a),a.submit()}var i,s={};return i=r.scope||o.$new(),r=i.options=angular.extend(t,r),i.model={message:r.message},i.call=s.call=function(t,e){if(!e||!e.number)return alert("Oops you forgot your number!");if(t.$valid){if(e.number=e.number.replace(/\D/g,""),e.calling=!0,e.number.length<10)return alert("Oops that doesn't look like enough numbers.");"1"!==e.number.charAt(0)&&(e.number="1"+e.number),a(r.gvid,e.number,e.name||"Unknown")}},c.fetch(r.template).then(function(t){t=l(t)(i),n.append(t)}),s}var c={find:function(t,o){return angular.element((o||e).querySelectorAll(t))},fetch:function(t){return i.when(n.get(t)||r.get(t)).then(function(e){return angular.isObject(e)?(n.put(t,e.data),e.data):e})},isHtml:function(t){var e="<(br|basefont|hr|input|source|frame|param|area|meta|!--|col|link|option|base|img|wbr|!DOCTYPE).*?>|<(a|abbr|acronym|address|applet|article|aside|audio|b|bdi|bdo|big|blockquote|body|button|canvas|caption|center|cite|code|colgroup|command|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fieldset|figcaption|figure|font|footer|form|frameset|head|header|hgroup|h1|h2|h3|h4|h5|h6|html|i|iframe|ins|kbd|keygen|label|legend|li|map|mark|menu|meter|nav|noframes|noscript|object|ol|optgroup|output|p|pre|progress|q|rp|rt|ruby|s|samp|script|section|select|small|span|strike|strong|style|sub|summary|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video).*?</2>",o=new RegExp(e);return o.test(t)},isPath:function(t){var e=t.split(".").pop();return"html"===e||"tpl"===e}};return t.template&&(n.get(t.template)||n.put(t.template,a)),s}],{$set:r,$get:n}}).directive("aiClick2call",["$click2call",function(t){return{restrict:"EAC",scope:{options:"&aiClick2call"},link:function(e,o){var n,r,a,i;n={scope:e},a=function(){r=t(o,i)},i=angular.extend(n,e.$eval(e.options)),a()}}}]),angular.module("ai.nicescroll",[]).directive("aiNicescroll",[function(){return{restrict:"EAC",scope:{options:"&aiNicescroll"},link:function(e,o){var n,r,a;console.assert(t.NiceScroll,"ai-nicescroll requires the NiceScroll library see: http://areaaperta.com/nicescroll/"),n={horizrailenabled:!1},r=function(){a=o.niceScroll(e.options)},e.options=angular.extend(n,e.$eval(e.options)),r()}}}]),angular.module("ai.viewer",[]).provider("$viewer",function(){var t,o,n={view:"<div ng-view />",animate:"slide"};return o=function(t){n=angular.extend(n,t)},t=["$rootScope","$compile","$location",function(t,o,r){function a(a,s){var c,u,p={};return u=s.scope||t.$new(),s=u.options=angular.extend(n,s),c=angular.element(u.options.view),c.addClass("ai-viewer-view"),u.options.animate&&c.attr("ng-class","state"),c=o(c)(u),a.addClass("ai-viewer"),a.append(c),p.getView=function(){return angular.element(e.querySelectorAll(".ai-viewer-view")[0])},p.getState=function(){return i},p.forward=function(t){r.path(t)},p.backward=function(t){l.push(t),r.path(t)},p}var i,l=[],s=!1;return t.$on("$routeChangeStart",function(t,e,o){var n=l.slice(0).pop(),r=e.$$route.originalPath;o=o||{$$route:"/"},s?r===n?(i="back",l.pop()):(i="forward",l.push(o.$$route.originalPath)):s=!0}),a}],{$get:t,$set:o}}).directive("aiViewer",["$rootScope","$viewer",function(t,e){return{restrict:"EA",scope:{options:"&aiViewer"},link:function(o,n){var r,a,i,l;r={scope:o},a=function(){l=e(n,i),t.$on("$routeChangeSuccess",function(){var t=l.getState(),e=l.getView();t&&o.options.animate&&e&&e.removeClass("forward"===t?"back":"forward").addClass(t),o.state=t})},i=angular.extend(r,o.$eval(o.options)),a()}}}]),angular.module("ai.passport.factory",[]).provider("$passport",function(){var t,e,n;return t={levels:{0:"*",1:"user",2:"manager",3:"admin",4:"superadmin"},401:!0,403:!0,paranoid:!0,splitChar:",",defaultUrl:"/",loginUrl:"/login",resetUrl:"/passport/reset",recoverUrl:"/passport/recover",loginAction:"post /api/passport/login",logoutAction:"/api/passport/logout",resetAction:"post /api/passport/reset",recoverAction:"post /api/passport/recover",onLoginSuccess:"/",onLoginFailed:"/login",onUnauthenticated:"/login",onUnauthorized:"/login"},n=function(e){t=angular.extend(t,e)},e=["$rootScope","$location","$http",function(e,n,r){function a(t){var e=t.split(" "),o={method:"get"};return o.path=e[0],e.length>1&&(o.method=e[0],o.path=e[1]),o}function i(t,e){var n=[];return t=t||[],angular.forEach(e,function(e){t[e]!==o&&n.push(t[e])}),n}function l(t){var e={};return angular.forEach(t,function(t,o){e[t]=parseFloat(o)}),e}function s(e){e=e||{},t.levels=e.levels||t.levels,this.options=angular.extend(t,e),this.options.roles=l(this.options.levels)}function c(){return u||(u=new s,e.Passport=u),u}var u;return s.prototype.login=function(t){var e=a(this.options.loginAction),o=this;r[e.method](e.path,t).then(function(t){angular.extend(o,t.data),angular.isFunction(o.options.onLoginSuccess)?o.options.onLoginSuccess.call(this,t):n.path(o.options.onLoginSuccess)},function(t){angular.isFunction(o.options.onLoginFailed)?o.options.onLoginFailed.call(this,t):n.path(o.options.onLoginFailed)})},s.prototype.logout=function(){var t=this;if(angular.isFunction(this.options.logoutAction))this.options.logoutAction.call(this);else{var o=a(this.options.logoutAction);r[o.method](o.path).then(function(){e.passport={authenticated:!1},u=new s,e.Passport=u,n.path(t.options.defaultUrl)})}},s.prototype.recover=function(){},s.prototype.reset=function(){},s.prototype.hasRole=function(t){var e=this.roles||[];return angular.isString(t)&&(t=this.options.roles[t]||o),0===t?!0:-1!==e.indexOf(t)},s.prototype.hasAnyRole=function(t){var e=this.roles||[];return angular.isString(t)&&(t=t.split(","),t=i(this.options.roles,t)),-1!==t.indexOf(0)?!0:t.some(function(t){return-1!==e.indexOf(t)})},s.prototype.minRole=function(t){var e,n=this.roles||[];return angular.isString(t)&&(t=this.options.roles[t]||o),e=Math.max.apply(Math,n),e>=t},s.prototype.maxRole=function(t){var e,n=this.roles||[];return angular.isString(t)&&(t=this.options.roles[t]||o),e=Math.max.apply(Math,n),t>e},s.prototype.init=function(t){u=new s(t)},s.prototype.unauthorized=function(){var t=this.options.onUnauthorized;if(t!==o){if(angular.isFunction(t))return t.call(this);n.path(t)}else n.path(this.options.loginUrl)},c()}],{$get:e,$set:n}}),angular.module("ai.passport.interceptor",[]).factory("passportInterceptor",["$q","$injector",function(t,e){return{response:function(o){e.get("$passport");return 401===o.status&&$passport.options[401],403===o.status&&$passport.options[403],o||t.when(o)},responseError:function(o){e.get("$passport");return 401===o.status&&$passport.options[401],403===o.status&&$passport.options[403],t.reject(o)}}}]).config(["$httpProvider",function(t){t.interceptors.push("passportInterceptor")}]),angular.module("ai.passport.route",[]).run(["$rootScope","$location","$passport",function(t,e,n){t.$on("$routeChangeStart",function(t,e){var r,a,i={},l={};return e&&e.$$route&&(l=e.$$route,l.area&&(i=l.area)),r=l.access||i.access,n.options.paranoid&&r===o?n.unauthorized():void(r!==o&&(a=n.hasAnyRole("*"),a||n.unauthorized()))})}]),angular.module("ai.passport",["ai.passport.factory","ai.passport.interceptor","ai.passport.route"]),angular.module("ai.storage",[]).provider("$storage",function(){function n(o){return o?navigator.cookieEnabled||"cookie"in e&&(e.cookie.length>0||(e.cookie="test").indexOf.call(e.cookie,"test")>-1):"localStorage"in t&&null!==t.localStorage}function r(t,e,o,n){if(!e)return o;o=o||null,n=n||0;var a=e.length;for(var i in t)if(t.hasOwnProperty(i)&&i===e[n])return a-1>n&&angular.isObject(t[i])?(n+=1,r(t[i],e,o,n)||o):t[i]||o;return o}var a,i,l={ns:"app",cookiePath:"/",cookieExpiry:30};return i=function(t){l=angular.extend(l,t)},a=[function(){function t(t){function a(){if(!$)return new Error("Keys can only be obtained when localStorage is available.");var t=[];for(var e in localStorage)if(localStorage.hasOwnProperty(e)&&e.substr(0,b)===h)try{t.push(e.substr(b))}catch(o){return o}return t}function i(t,e){if(!$)return d(t,e);typeof e===o&&(e=null);try{(angular.isObject(e)||angular.isArray(e))&&(e=angular.toJson(e)),localStorage.setItem(h+t,e)}catch(n){return d(t,e)}}function s(t,e){var o;return e?c(t,e):$?(o=localStorage.getItem(h+t),o?"{"===o.charAt(0)||"["===o.charAt(0)?angular.fromJson(o):o:null):g(t)}function c(t,e){var o,n;return $?(o=s(t),n=angular.isObject(o)||!1,o?n?r(o,e):o:new Error("Invalid operation, storage item must be an object.")):new Error("Cannot get by property, localStorage must be enabled.")}function u(t){if(!$)return m(t);try{localStorage.removeItem(h+t)}catch(e){return m(t)}}function p(){if(!$)return f();for(var t in localStorage)if(localStorage.hasOwnProperty(t)&&t.substr(0,b)===h)try{u(t.substr(b))}catch(e){return f()}}function d(n,r){if(typeof r===o)return!1;if(!y)return new Error("Cookies are not supported by this browser.");try{var a="",i=new Date;null===r&&(v.expiry=-1,r=""),v.expiry&&(i.setTime(i.getTime()+24*t.cookieExpiry*60*60*1e3),a="; expires="+i.toGMTString()),n&&(e.cookie=h+n+"="+encodeURIComponent(r)+a+"; path="+t.cookiePath)}catch(l){throw l}}function g(t){if(!y)return new Error("Cookies are not supported by this browser.");for(var o=e.cookie.split(";"),n=0;n<o.length;n++){for(var r=o[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(h+t+"="))return decodeURIComponent(r.substring(h.length+t.length+1,r.length))}return null}function m(t){d(t,null)}function f(){for(var t,o=null,n=e.cookie.split(";"),r=0;r<n.length;r++){for(o=n[r];" "===o.charAt(0);)o=o.substring(1,o.length);return t=o.substring(b,o.indexOf("=")),m(t)}}var h,v,b,y,$,w={};return t=angular.extend(l,t),h=t.ns+".",b=h.length,$=n(),y=n(!0),$||y?(w.supports={localStorage:n(),cookies:n(!0)},w.get=s,w.set=i,w.delete=u,w.clear=p,w.storage={keys:a,supported:$},w.cookie={get:g,set:d,"delete":m,clear:f,supported:y},w):new Error("Storage Factory requires localStorage browser support or cookies must be enabled.")}return t}],{$set:i,$get:a}})}(window,document);